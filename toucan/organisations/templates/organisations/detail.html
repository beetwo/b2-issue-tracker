{% extends 'organisations/base.html' %}
{% load i18n imagekit %}

{% block organisation_page_title %}
    {{ organisation.name }}
{% endblock %}

{% block organisation_details %}

{{ organisation.description|linebreaks}}

<dl>
    {% if organisation.homepage %}
    <dt>{% trans 'Homepage' %}</dt>
    <dd>{{ organisation.homepage|urlize }}</dd>
    {% endif %}
</dl>


{% endblock %}

{% block organisation_page_controls %}

    {% if organisation.logo %}
        <p>
        {% thumbnail '250x250' organisation.logo crop=0 %}
        </p>
    {% endif %}

    {% if can_edit_details %}
    <br />
    <p class="text-right">
        <a href="{% url 'organisations:edit' %}"
            class="btn btn-primary">
            {% trans 'Edit organisation details' %}
            <i class="fa fa-edit"></i>
        </a>
    </p>
    {% endif %}

{% endblock %}


{% block organisation_main %}


{% with memberships=organisation.active_memberships %}
<hr />

<div class="row">
    <div class="col-sm-12">
        <h2>{% trans 'Members' %} ({{ memberships|length }})</h2>
        <hr />
        <table class="table table-striped">
            <tbody>
            {% for membership in memberships %}
            {% with u=membership.user %}
                <tr>
                    <td>
{#                        <a href="#">Image?</a>#}
                    </td>
                    <td>
                        <a href="{% url 'user_profile:public_profile' username=u.username %}">
                            {{ u.username }}
                            {% if u == user %}&nbsp;<i class="fa fa-user"></i>{% endif %}
                        </a>
                    </td>
                    <td>
                        <span class="label label-default">
                        {{ membership.get_role_display|capfirst }}
                        </span>
                    </td>
                </tr>
            {% endwith %}
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>



<div class="row">

    {% if is_member %}
        {% if can_invite %}
        <p class="text-right">
            <a class="btn btn-primary" href="{% url 'invite_to_org' organisation_id=organisation.pk %}">
                {% trans 'Invite new members' %} <i class="fa fa-envelope"></i>
            </a>
        </p>
        {% endif %}
    {% endif %}
</div>

<div id="'locations">

<h2>{% trans 'Locations' %}</h2>

<hr />

<table class="table table-striped">
    <tbody>
    {% for location in locations %}
    <tr>
        <td>
            {% if location.name %}<b>{{ location.name }}</b><br />{% endif %}
            {{ location.city }}
        </td>
        <td>
            {% if can_edit_locations %}
                <a class='btn btn-sm btn-primary' href="{% url 'organisations:locations:edit' pk=location.pk %}">Edit</a>
                <a class='btn btn-sm btn-default' href="{% url 'organisations:locations:delete' pk=location.pk %}">Delete</a>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>

{% if can_edit_locations %}
    <p class="text-right">
        <a class="btn btn-primary" href="{% url 'organisations:locations:add' %}">
            {% trans 'Add Location' %} <i class="fa fa-globe"></i>
        </a>
    </p>
{% endif %}
</div>

{% endwith %}
{% endblock %}
